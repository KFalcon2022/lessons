# HTTP-клиенты. Практика отправки запросов

Мы уже изучили достаточно большой объем теоретической информации об HTTP и пришло время закрепить ее на практике. Для
этого нам необходимо познакомиться с понятием **HTTP-клиента** и изучить работу с одним или нескольким из них.

## HTTP-клиенты

HTTP-клиент - программа или программный компонент, который предоставляет возможность отправлять
HTTP-запросы. В зависимости от контекста значение может немного разниться, но общая суть остается той же.
HTTP-клиент, в узком понимании, является тем самым клиентом в клиент-серверном приложении. В случае, если это
приложение общается по HTTP (а не другому протоколу), клиентом выступает именно HTTP-клиент.

В целом, как минимум с одним HTTP-клиентом вы умеете работать - это обычный браузер. Но в данном случае отправка
запросов не является его основной функцией - ведь большая часть его работы заключается в интерпретации ответов,
которые получены в качестве ответа на запрос. Так, браузер умеет работать с HTML и JavaScript (который, в свою
очередь, имеет свои средства для выполнения HTTP-запросов). Кроме того, браузеры обычно умеют работать с несколькими
протоколами. И, наконец, браузер плохо подходит для ситуаций, когда нам необходимо именно отправлять запросы в
ручном режиме, т.е. плохо подходит для тестирования и отладки запросов. Для этого есть более специализированные
инструменты.

За пределами браузера под HTTP-клиентом обычно понимают одно из двух:

1. Специализированная программа, предназначенная для отправки HTTP-запросов. В отличие от стандартных средства
   браузера, такая программа позволяет в явном виде указывать, какой запрос, с какими параметрами, заголовками и
   телом мы хотим отправить. Дополнительно она может содержать возможность сохранения определенных конфигураций
   запросов, функциональность для совместной работы нескольких пользователей и т.д. При этом представлена такая
   программа может быть как консольным или десктопным приложением, так и обычным плагином для браузера - ведь браузер
   умеет все то же самое, просто его базовые возможности не направлены на то, чтобы делать это вручную.
2. Компонент языка программирования. Например, Java-класс или Java-библиотека, которая позволяет конфигурировать и
   отправлять запросы. Это может быть полезно как для клиентских приложений (в JavaScript или десктопных/мобильных
   приложениях, взаимодействующих с сервером), так и для серверных программ - для межсерверной коммуникации. Кроме
   того, автоматизированные тесты тоже требуют использования HTTP-клиентов для тестирования API.

Возможно, мы еще столкнемся с HTTP-клиентами в Java, но сегодняшняя статья больше направлена на знакомство с
клиентами в первой интерпретации. Ниже представлены несколько из них.

## Swagger

Строго говоря, именно Swagger не является HTTP-клиентом в принципе. Это скорее набор инструментов, которые позволяют
описывать (документировать) HTTP-запросы и просматривать их описание в удобном формате.

Как раз с изучением документации запросов с помощью Swagger вы столкнетесь в практической части. Но есть еще один
важный момент: если серверное приложение использует специализированную библиотеку, это позволяет открыть
документацию запросов прямо в браузере, обратившись по специальному адресу в этом приложении. И там же отправлять
эти запросы в удобном формате - вплоть до предустановленных схем параметров и значений определенных параметров в
соответствии с прописанными на сервере правилами.

Таким образом, Swagger позволяет эмулировать в браузере HTTP-клиент для отдельно взятого серверного приложения.
Может звучать запутанно, но все станет понятнее после начала выполнения практического задания.

В целом, я не рекомендую ограничиваться знакомством только со Swagger, воспринимая его в первую очередь как
инструмент для чтения документации к HTTP-запросам.

## cURL

cURL (или curl) - консольный HTTP-клиент. В силу отсутствия GUI он не очень удобен в работе, по сравнению с
альтернативными решениями, но имеет ряд неоспоримых преимуществ:

1. Консольный интерфейс. Если вам необходимо отправить простой запрос и/или ваша работа тесно связана с командной
   строкой (сисадмины, девопсы и другие) - использование консольного инструмента банально быстрее, чем любое решение
   с GUI;
2. Наглядность. Безусловно, при частом использовании HTTP-клиента не хочется тратить время на однотипные действия
   или сталкиваться с неудобным интерфейсом - GUI здесь часто выигрывает у консольных программ. Но оформление
   запроса в cURL позволяет намного лучше понять содержимое HTTP-запросов - описанный в cURL запрос лаконично
   отображает все содержимое в виде текста. Кроме того, это позволяет новичкам лучше запомнить составные части
   запроса;
3. Удобный формат для передачи запроса. Не так редко возникают ситуации, когда при тестировании API находят ошибки,
   воспроизводимые для конкретного набора параметров. Именно возможность представить запрос в виде обычного
   человекочитаемого текста является большим достижением данного клиента. В случае с графическими клиентами
   содержимое запроса может быть разбросано по множеству элементов программы, что затрудняет передачу конфигурации
   запроса другому специалисту.

> *Справедливости ради, многие десктопные приложения решают эту проблему через возможность экспортировать запрос...
> Например, в формате cURL:)

В этой статье мы не будем подробно разбирать работу с каждым рассматриваемым инструментом - они достаточно просты
для самостоятельного освоения. Кроме того, в случае с cURL пример сгенерированного запроса для практической части можно
будет посмотреть в Swagger - там есть специальное поле, отображающее, как каждый выполняемый запрос выглядел бы в cURL.

Ознакомиться с общими принципами формирования можно, например, здесь:
[ссылка](https://docs.oracle.com/en/cloud/saas/marketing/eloqua-develop/Developers/GettingStarted/APIRequests/curl-formats.htm).

Скачать cURL для вашей операционной системы можно [здесь](https://curl.se/download.html). Для некоторых ОС (включая
Windows 10 и выше) он является предустановленным.

Пример POST-запроса в cURL для Windows:

В зависимости от ОС могут быть незначительные отличия в оформлении. В т.ч. из-за различных правил оформления,
например, переносов строк:

```cmd
curl -X POST "http://localhost:8080/private/v1/car" ^
-H "accept: */*" ^
-H "Content-Type: application/json" ^
-d "{\"brandId\": \"string\", \"year\": 1900, \"model\": \"string\", \"color\": \"string\", \"number\": \"string\", \"actualTechnicalInspection\": true}"
```

## Postman

Postman - наиболее популярный из инструментов для отправки запросов с графическим интерфейсом. Его, среди прочих,
часто используют мануальные тестировщики.

Существует как в десктопном формате, так и веб-версия: [ссылка](https://www.postman.com/downloads/).

Большой плюс Postman в том, что он предлагает возможность сохранять запросы для повторного использования, объединять
их в "коллекции" по логическим группам, делиться такими коллекциями и т.д. К сожалению, часть функционала является
платной, но для большинства задач с запасом хватает бесплатного режима.

В целом, это один из наиболее дружелюбных и популярных инструментов для работы с HTTP-запросами на данный момент.
Как за счет предлагаемых возможностей, так и благодаря интуитивно-понятному интерфейсу.

## IDEA HTTP Client

Да, возможность отправлять HTTP-запросы есть и в IntelliJ IDEA. К сожалению, только в Ultimate-версии.

Подробности можно найти [здесь](https://www.jetbrains.com/help/idea/http-client-in-product-code-editor.html).

Вкратце суть взаимодействия сводится к созданию файлов в формате `.http` и описании в них запросов в упрощенном виде - 
чем-то напоминающем тот, в котором они были описывались в первых статьях, посвященных HTTP. Ниже предствален пример 
содержимого такого http-файла:

```http request
POST http://localhost:8080/private/v1/car
accept: */*
Content-Type: application/json

{
  "brandId": "string",
  "year": 1900,
  "model": "string",
  "color": "string",
  "number": "string",
  "actualTechnicalInspection": true
}
```

Если к этому формату добавить характерные флаги - он окажется крайне похожим на формат, используемый cURL. Также 
IDEA умеет воспринимать и оригинальный cURL формат (и Postman-коллекции), с конвертацией к виду выше.

Все подробности можно найти по приложенной ранее ссылке. Также в самой IDEA можно посмотреть примеры различных 
запросов после создания файла `.http`.

В целом, не могу назвать этот инструмент популярным, но для локального использования он вполне удобен. Особенно если 
рассматривать его как более дружелюбный вариант cURL для базовых нужд.

## Заключение

Основные из описанных сегодня инструментов - cURL и Postman - весьма обширны по возможностям - намного шире, чем
описано в этой статье. Те из читателей, кто работает в смежных с разработкой областях, могут знать об этом не
понаслышке. Однако цель этой статьи - дать общую информацию об инструментах тем, кто лишь недавно начал знакомство с
HTTP. 

В силу этого текст сделан максимально облегченным и наиболее важной его частью является практическая составляющая - 
как изучение самих HTTP-клиентов, так и взаимодействие с предложенным ниже приложением.

#### С теорией на сегодня все!

![img.png](../../../commonmedia/defaultFooter.jpg)

Переходим к практике:

## Задача

Репозиторий для практики представлен по [ссылке](https://github.com/KFalcon2022/test-http-client).

В readme-файле к нему можно найти инструкцию по запуску и описание задачи. Отдельно отмечу, что знакомство с кодовой
базой остается на ваше усмотрение - в ней использовано много пока незнакомых нам технологий. Основная задача
приложения - дать вам возможность почувствовать принципы работы клиент-серверного приложения со стороны клиента.

> Если что-то непонятно или не получается – welcome в комменты к посту или в лс:)
>
> Канал: https://t.me/ViamSupervadetVadens
>
> Мой тг: https://t.me/ironicMotherfucker
>
> **Дорогу осилит идущий!**

