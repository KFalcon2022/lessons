![](../../commonmedia/header.png)

***

   

Основные термины реляционных БД и что такое SQL (DDL, DML, etc.)
================================================================

В рамках данной статьи мы начнем изучение того, как взаимодействовать с реляционной базой данных (тот же способ актуален для некоторых NoSQL БД).

Мы уже шапочно знакомы с такими терминами как база данных, схема, таблица и колонка. В рамках раздела к ним постепенно добавятся и другие: представление, индекс, процедура, функция, триггер, Primary Key и Foreign Key, а также многие другие. Но эти термины мы будем изучать постепенно, безотрывно от практики.

Практика же, в свою очередь, будет неразрывно связано с SQL. Что это такое и какие группы операторов доступны в рамках него – разберемся уже сегодня.

**SQL** (**_Structured Query Language_**) – как понятно из названия, является языком запросов. Запросов к базе данных. Именно с помощью него создаются и изменяются таблицы, добавляются, удаляются и извлекаются данные.

SQL, строго говоря, не является языком программирования (имхо. Не все согласны с моей точкой зрения), но имеет многие его черты. Вплоть до того, что SQL относят к конкретным парадигмам программирования.

Мы уже знакомы с несколькими из таких парадигм: процедурная, объектно-ориентированная, функциональная.

SQL считается декларативным языком. **Декларативная парадигма** – крупное множество, в которое входит, в том числе, и функциональное программирование (в качестве одного из подвидов). Мы уже затрагивали эту тему ранее.

Декларативное программирование характеризуется тем, что не говорит исполняемой среде _как_ сделать то, что нам требуется. Она лишь описывает (_декларирует_) какой результат мы ожидаем. В случае с SQL это означает, что мы не описываем _как_ извлекать данные из таблицы, например. Не описываем, какие алгоритмы использовать для поиска нужных нам данных по указанным фильтрам, какими алгоритмами их сортировать, какими средствами оптимизировать эти операции и пр.**\*** Мы лишь описываем, под какие критерии должен подходить результат. В чем-то это похоже на то, как можно фильтровать и сортировать данные в рамках таблицы Excel.  

Пример выше во многом утрирован и воспринимать декларативную парадигму только через его призму не стоит. Но он позволяет начать формировать понимание об инструменте, с которым мы будем знакомиться в рамках ближайших десятков уроков. Погружение и знакомство с SQL будет длинным, хоть и не слишком сложным, на фоне многопоточности и Stream API. На самом деле, кроличья нора тоже весьма глубока, но большую часть этого пути вы пройдете уже за пределами курса – начинающему разработчику достаточно основ, которым мы и посвятим большую часть раздела.

> **\*** Как и всегда, есть НО. SQL, в сущности, является лишь абстрактной концепцией, набором спецификаций, которым должен удовлетворять API реляционной СУБД. При этом каждая СУБД реализует данные спецификации по-своему. SQL в каждой отдельной СУБД имеет ряд собственных инструментов, не заложенных в стандарт языка. Но в данном случае важнее другое.  
> За счет того, что язык декларативный, мы не влияем на выбор алгоритмов и используемых внутренних механизмов. Это берет на себя СУБД и выбирает инструменты, выполняющие наши требования, на базе внутренних планировщиков и алгоритмов. Какие-то СУБД это делают более эффективно, какие-то – менее. Поэтому некоторые из них предоставляют возможность указывать, какие инструменты СУБД должна использовать для выполнения наших требований, тем самым позволяя в ручном режиме оптимизировать конкретные операции. Это выходит далеко за рамки нашего курса, но я считаю необходимым подсветить, что такие нюансы есть и зависят они от конкретной СУБД.

Первое, что нужно понимать – именно с помощью SQL происходит все общение с базой данных. Точнее, с помощью SQL-запросов. Даже если вы делаете что-то через GUI условного DataGrip’а, внутри все равно формируется и отправляется SQL-запрос к базе данных. Программы-клиенты с GUI лишь оборачивают это в графическую оболочку, которая может быть более дружелюбной, чем консоль и SQL для базовых рутинных операций

Теперь, когда сама концепция SQL и его актуальность стали более понятны, посмотрим, какие инструменты (точнее, группы инструментов) он предоставляет.

К таковым можно отнести:

· **Операторы**. В Java к операторам относятся +, -, ++ (инкремент) и прочие. В SQL операторы более «верхнеуровневые» – на них лежит куда большая логическая нагрузка, в силу парадигмы языка. В некоторой степени, большую часть раздела можно описать как «_знакомство с операторами SQL, их актуальностью и способами их применения_»;

· **Функции**. В данном случае подразумевает широкий спектр базовых функций и процедур, которые предоставляет SQL. Проводя аналогии с Java – некий аналог JDK. Аналогия очень грубая, поэтому предложу пару примеров. _sum()_, _count()_, _avg()_ – функции для сложения, подсчета и нахождения среднего значения. Примеры наглядные, но не описывающие всей широты возможностей, предоставляемых SQL из коробки. С функциями мы будем знакомиться по мере необходимости в рамках изучения операторов и возможностей SQL.

Операторы, в свою очередь, можно разделить на несколько крупных групп. На мой взгляд, знакомство с этими группами – основная цель этой статьи. Именно на базе этих групп становится понятно, как можно классифицировать взаимодействие с базой данных**\***.

> **\*** На мой взгляд, не самая удачная формулировка, но лучше я не придумал. Если у кого-то будут идеи, как донести мысль понятнее – welcome.

### DDL

**DDL** (**_Data definition language_**) – набор операторов, позволяющих взаимодействовать со структурой хранения данных. Сюда относятся инструменты для создания, изменения и удаления структурных элементов БД: самих БД, схем, таблиц, индексов и т.д.

Иными словами, DDL описывает только _как_ следует хранить данные. На этом его полномочия все.

В качестве примера: мы создавали БД и схему через оператор CREATE:

```java
CREATE DATABASE %db_name%;
CREATE SCHEMA %schema_name%;
```

Обе строки выше – SQL-запросы, которые относятся к DDL. Запросы на удаление базы данных и схемы (через оператор DROP) относятся к этой же категории. Строго говоря, категория запроса определяется по ключевому оператору. Операторы CREATE и DROP (а также ALTER, с которым мы еще не знакомы) относятся к DDL.

### DML

**DML** (**_Data Manipulation Language_**) – набор операторов для взаимодействия с данными. Все то, что описывает способы добавления, изменения, удаления и чтения записей из таблиц. Строго говоря, не только таблиц, но сейчас это не важно. Ключевым ограничением зоны ответственности DML являются именно данные.

Таким образом, если DDL отвечает за структуру БД – скелет, то DML – за ее наполнение (мышцы или любая другая удобная вам аналогия).

Проводя параллели с Java, DDL можно представить, как набор операторов для описания класса, а DML – в качестве совокупности операторов для взаимодействия с объектами этого класса. Аналогия не самая корректная, но позволяет уловить саму идею.

К слову, именно этой частью SQL, зачастую, ограничивается работа с БД для аналитика данных (Data Analyst) – мы рассматривали эту роль в рамках знакомства с составом проектной команды.

### DCL

**DCL** (**_Data Control Language_**) объединяет совокупность операторов для разграничения прав доступа к данным. Взаимодействие с ролями и пользователями в рамках БД, предоставления и отзыв прав на конкретные действия в рамках БД, схемы или таблицы.

Привилегии покрывают доступность для пользователя (или его роли) как DDL, так и DML-операций.

В целом, эту часть SQL мы, скорее всего, не затронем в рамках текущего курса. Она не слишком актуальна для разработчиков. Обычно DCL остается зоной ответственности администратора БД (DBA).

### TCL

**TCL** (**_Transaction Control Language_**) – часть SQL, объединяющая операторы по управлению **транзакциями**.

Концепцию транзакций, их свойства и проблемы мы будем рассматривать в рамках отдельного урока и часто будем сталкиваться с этим термином в Java – от знакомства с _JDBC_, до изучения в рамках _Hibernate_ и _Spring Data_. Иными словами, на каждом из возможных уровней абстракции при работе с БД в Java-разработке.

Пока же постараемся ухватить самую суть: транзакция позволяет объединять несколько различных запросов к БД в единую инструкцию. Такая инструкция является атомарной**\*** (на уровне СУБД, но не процессора) и обладает рядом других свойств.

> **\*** Не совсем так, но с этими нюансами разберемся, когда придет время. Пока вполне можно считать, что транзакция атомарна.

По сути, операторы, относящиеся к TCL, позволяют произвести фиксацию изменений в рамках транзакции, отмену этих изменений (в силу возникновения ошибки), управлять настройкой конкретной транзакции и т.д.

Важно отметить, что перечень операций, которые являются транзакционными, зависит от конкретной СУБД.

Какие-то из них гарантируют тразнакционность **как для DML, так и для DDL-операций**, какие-то – **для DML и части DDL** (сюда относится и PostgreSQL), а некоторые ограничивают транзакционность **только DML-запросами**.

Возможно, это не так критично, пока мы работаем с SQL напрямую, но будет играть определенную роль, когда взаимодействие с БД будет происходить через внешнее приложение. Особенно важно помнить о подобных особенностях при использовании инструментов миграций.

### В качестве заключения

SQL – очень обширная и разносторонняя тема. Скорее всего, у каждого начинающего (и продолжающего) разработчика бывают этапы, когда он считает, что постиг дзен и покорил SQL. Не поддавайтесь этим иллюзиям. Скорее всего, проблема, при которой ваших знаний недостаточно – еще впереди.

Последнего не стоит бояться, это нормально. Изучение любого инструмента – процесс итеративный. Данный курс призван дать основы и подсветить возможные направления для углубления знаний. И этого, вероятно, будет вполне достаточно junior’у и, в большинстве случаев, middle’у. Но рано или поздно вам предстоит осознать, что путь только начался.

Рекомендую заранее подготовить свое ЧСВ к этому моменту:)

![](../../commonmedia/footer.png)

Если что-то непонятно или не получается – welcome в комменты к посту или в лс:)

Канал: [https://t.me/ViamSupervadetVadens](https://t.me/ViamSupervadetVadens)

Мой тг: [https://t.me/ironicMotherfucker](https://t.me/ironicMotherfucker)

_Дорогу осилит идущий!_